(function(d){function m(a,b){if(a.tagName===b&&"refresh"===a.getAttribute("data-navigation")){for(var c=!0;a&&c;)a.getAttribute&&(c="noajax"!==a.getAttribute("data-navigation")),a=a.parentNode;return c}return!1}function n(a,b){var c=new d.XMLHttpRequest;c.onreadystatechange=p(c,b,a);c.open("get",q(a));c.send()}function q(a){a+=0<a.indexOf("?")?"&":"?";return a+="refreshajax="+d.encodeURIComponent(k)}function p(a,b,c){var f=k;return function(){if(4===a.readyState&&200===a.status){var g=d.JSON.parse(a.responseText);
r(g,b,c,f)}}}function r(a,b,c,f){for(var g in a.Panels){var e=d.document.getElementById(g);e.innerHTML=a.Panels[g];var h;"function"===typeof d.Event?h=new d.Event("refreshajax"):(h=d.document.createEvent("Event"),h.initEvent("refreshajax",!1,!1));e.dispatchEvent(h)}c||(c=a.Link);b&&f!==c&&d.history.pushState(c,d.document.title,c);s[f+"&"+c]=a;k=c}if(d.history&&d.history.pushState){var l={};d.document.addEventListener("click",function(a){var b=a.target;a.ctrlKey||a.shiftKey||!m(b,"A")||(a.preventDefault(),
n(b.getAttribute("href"),!0));"INPUT"===b.tagName&&b.name&&("submit"===b.type&&(l[b.name]=b.value),"image"===b.type&&(l[b.name+".x"]=d.Math.max(0,a.offsetX),l[b.name+".y"]=d.Math.max(0,a.offsetY)))});var t=/^(INPUT|TEXTAREA|SELECT)$/,u=/^(button|image|submit|reset|file)$/,v=/^(checkbox|radio)$/;d.document.addEventListener("submit",function(a){if(m(a.target,"FORM")){var b=a.target.elements,c=new d.XMLHttpRequest;c.onreadystatechange=p(c,!0,null);for(var f={},g=0;g<b.length;g++){var e=b[g];!t.test(e.tagName)||
!e.name||u.test(e.type)||e.disabled||v.test(e.type)&&!e.checked||(f[e.name]=e.value)}for(var h in l)f[h]=l[h];l={};a.preventDefault();c.open("post",q(a.target.getAttribute("action")));c.setRequestHeader("Content-Type","application/json");c.send(d.JSON.stringify(f))}});var k=d.location.pathname+d.location.search,s={};d.addEventListener("popstate",function(a){a=d.location.pathname+d.location.search;if(k!==a){var b=s[k+"&"+a];b?r(b,!1,a,k):n(a,!1)}})}})(window);