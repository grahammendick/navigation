(function(c){function s(a){a=a.elements;for(var b={},d=0;d<a.length;d++){var c=a[d];!t.test(c.tagName)||!c.name||u.test(c.type)||c.disabled||v.test(c.type)&&!c.checked||(b[c.name]=c.value)}for(var f in g)b[f]=g[f];g={};return b}function m(a,b){if(a.tagName===b&&"refresh"===a.getAttribute("data-navigation")){for(var c=!0;a&&c;)a.getAttribute&&(c="noajax"!==a.getAttribute("data-navigation")),a=a.parentNode;return c}return!1}function k(a,b,d){var e=new c.XMLHttpRequest;e.onreadystatechange=n(e,b);e.open("get",
p(a,d));e.send()}function p(a,b){a+=0<a.indexOf("?")?"&":"?";a+="refreshajax="+c.encodeURIComponent(f);a+="&navigation="+(b?"refresh":"history");b&&(a=l(b,a,"data-include-current","includecurrent"),a=l(b,a,"data-current-keys","currentkeys"),a=l(b,a,"data-to-keys","tokeys"));return a}function l(a,b,d,e){(a=a.getAttribute(d))&&(b+="&"+e+"="+c.encodeURIComponent(a));return b}function n(a,b){var d=f;return function(){if(4===a.readyState&&200===a.status){var e=c.JSON.parse(a.responseText);q(e,b,d)}}}function q(a,
b,d){var e=a.Link;r[d+"&"+e]=a;if(f===d){for(var g in a.Panels){d=c.document.getElementById(g);d.innerHTML=a.Panels[g];var h;"function"===typeof c.Event?h=new c.Event("refreshajax"):(h=c.document.createEvent("Event"),h.initEvent("refreshajax",!1,!1));d.dispatchEvent(h)}b&&f!==e&&c.history.pushState(e,c.document.title,e);f=e}}if(c.history&&c.history.pushState){var g={};c.document.addEventListener("click",function(a){var b=a.target;a.ctrlKey||a.shiftKey||!m(b,"A")||(a.preventDefault(),k(b.getAttribute("href"),
!0,b));"INPUT"===b.tagName&&b.name&&("submit"===b.type&&(g[b.name]=b.value),"image"===b.type&&(g[b.name+".x"]=c.Math.max(0,a.offsetX),g[b.name+".y"]=c.Math.max(0,a.offsetY)))});c.document.addEventListener("submit",function(a){var b=a.target;if(m(b,"FORM")){var d=new c.XMLHttpRequest;d.onreadystatechange=n(d,!0);a.preventDefault();d.open("post",p(b.getAttribute("action"),b));d.setRequestHeader("Content-Type","application/json");d.send(c.JSON.stringify(s(b)))}});var t=/^INPUT|TEXTAREA|SELECT$/,u=/^button|image|submit|reset|file$/,
v=/^checkbox|radio$/,f=c.location.pathname+c.location.search,r={};c.addEventListener("popstate",function(a){a=c.location.pathname+c.location.search;if(f!==a){var b=r[f+"&"+a];if(b)try{q(b,!1,f)}catch(d){k(a,!1)}else k(a,!1)}})}})(window);