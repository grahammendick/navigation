(function(c){function s(a){a=a.elements;for(var b={},d=0;d<a.length;d++){var c=a[d];!t.test(c.tagName)||!c.name||u.test(c.type)||c.disabled||v.test(c.type)&&!c.checked||(b[c.name]=c.value)}for(var e in f)b[e]=f[e];f={};return b}function m(a,b){if(a.tagName===b&&"refresh"===a.getAttribute("data-navigation")){for(var c=!0;a&&c;)a.getAttribute&&(c="noajax"!==a.getAttribute("data-navigation")),a=a.parentNode;return c}return!1}function k(a,b,d,g){var e=new c.XMLHttpRequest;e.onreadystatechange=n(e,b,g);
e.open("get",p(a,d));e.send()}function p(a,b){a+=0<a.indexOf("?")?"&":"?";a+="refreshajax="+c.encodeURIComponent(h);a+="&navigation="+(b?"refresh":"history");b&&(a=l(b,a,"data-include-current","includecurrent"),a=l(b,a,"data-current-keys","currentkeys"),a=l(b,a,"data-to-keys","tokeys"));return a}function l(a,b,d,g){(a=a.getAttribute(d))&&(b+="&"+g+"="+c.encodeURIComponent(a));return b}function n(a,b,d){var g=h;return function(){if(4===a.readyState&&200===a.status){var e=c.JSON.parse(a.responseText);
e.Title||(e.Title=d?d:c.document.title);q(e,b,g)}}}function q(a,b,d){var g=a.Link;r[d+"&"+g]=a;if(h===d){for(var e in a.Panels){d=c.document.getElementById(e);d.innerHTML=a.Panels[e];var f;"function"===typeof c.Event?f=new c.Event("refreshajax"):(f=c.document.createEvent("Event"),f.initEvent("refreshajax",!1,!1));d.dispatchEvent(f)}b&&h!==g&&c.history.pushState(a.Title,a.Title,g);c.document.title=a.Title;h=g}}if(c.history&&c.history.pushState){var f={};c.document.addEventListener("click",function(a){var b=
a.target;a.ctrlKey||a.shiftKey||!m(b,"A")||(a.preventDefault(),k(b.getAttribute("href"),!0,b));"INPUT"===b.tagName&&b.name&&("submit"===b.type&&(f[b.name]=b.value),"image"===b.type&&(f[b.name+".x"]=c.Math.max(0,a.offsetX),f[b.name+".y"]=c.Math.max(0,a.offsetY)))});c.document.addEventListener("submit",function(a){var b=a.target;if(m(b,"FORM")){var d=new c.XMLHttpRequest;d.onreadystatechange=n(d,!0);a.preventDefault();d.open("post",p(b.getAttribute("action"),b));d.setRequestHeader("Content-Type","application/json");
d.send(c.JSON.stringify(s(b)))}});var t=/^INPUT|TEXTAREA|SELECT$/,u=/^button|image|submit|reset|file$/,v=/^checkbox|radio$/,h=c.location.pathname+c.location.search,r={};c.addEventListener("popstate",function(a){var b=c.location.pathname+c.location.search;if(h!==b){var d=r[h+"&"+b];if(d)try{q(d,!1,h)}catch(f){k(b,!1,null,a.state)}else k(b,!1,null,a.state)}})}})(window);