(function(b){function r(a){a=a.elements;for(var c={},d=0;d<a.length;d++){var b=a[d];!s.test(b.tagName)||!b.name||t.test(b.type)||b.disabled||u.test(b.type)&&!b.checked||(c[b.name]=b.value)}for(var f in g)c[f]=g[f];g={};return c}function k(a,c){if(a.tagName===c&&"refresh"===a.getAttribute("data-navigation")){for(var b=!0;a&&b;)a.getAttribute&&(b="noajax"!==a.getAttribute("data-navigation")),a=a.parentNode;return b}return!1}function l(a,c,d){var e=new b.XMLHttpRequest;e.onreadystatechange=m(e,c);e.open("get",
n(a,d));e.send()}function n(a,c){a+=0<a.indexOf("?")?"&":"?";a+="refreshajax="+b.encodeURIComponent(f);c&&c.getAttribute("data-include-current")&&(a+="&includecurrent=true");var d=c?c.getAttribute("data-current-keys"):null;d&&(a+="&currentkeys="+b.encodeURIComponent(d));return a}function m(a,c){var d=f;return function(){if(4===a.readyState&&200===a.status){var e=b.JSON.parse(a.responseText);p(e,c,d)}}}function p(a,c,d){var e=a.Link;q[d+"&"+e]=a;if(f===d){for(var g in a.Panels){d=b.document.getElementById(g);
d.innerHTML=a.Panels[g];var h;"function"===typeof b.Event?h=new b.Event("refreshajax"):(h=b.document.createEvent("Event"),h.initEvent("refreshajax",!1,!1));d.dispatchEvent(h)}c&&f!==e&&b.history.pushState(e,b.document.title,e);f=e}}if(b.history&&b.history.pushState){var g={};b.document.addEventListener("click",function(a){var c=a.target;a.ctrlKey||a.shiftKey||!k(c,"A")||(a.preventDefault(),l(c.getAttribute("href"),!0,c));"INPUT"===c.tagName&&c.name&&("submit"===c.type&&(g[c.name]=c.value),"image"===
c.type&&(g[c.name+".x"]=b.Math.max(0,a.offsetX),g[c.name+".y"]=b.Math.max(0,a.offsetY)))});b.document.addEventListener("submit",function(a){var c=a.target;if(k(c,"FORM")){var d=new b.XMLHttpRequest;d.onreadystatechange=m(d,!0);a.preventDefault();d.open("post",n(c.getAttribute("action"),c));d.setRequestHeader("Content-Type","application/json");d.send(b.JSON.stringify(r(c)))}});var s=/^INPUT|TEXTAREA|SELECT$/,t=/^button|image|submit|reset|file$/,u=/^checkbox|radio$/,f=b.location.pathname+b.location.search,
q={};b.addEventListener("popstate",function(a){a=b.location.pathname+b.location.search;if(f!==a){var c=q[f+"&"+a];c?p(c,!1,f):l(a,!1)}})}})(window);