(function(f){function w(a){a=a.elements;for(var b={},c=0;c<a.length;c++){var e=a[c];!x.test(e.tagName)||!e.name||y.test(e.type)||e.disabled||z.test(e.type)&&!e.checked||(b[e.name]=e.value)}for(var d in h)b[d]=h[d];h={};return b}function r(a,b){for(var c=null;a;){if(a.getAttribute){var e=a.getAttribute("data-navigation");c||a.tagName!==b||"refresh"!==e||(c=a);if("noajax"===e)return null}a=a.parentNode}return c}function s(a,b,c,e){var d=new f.XMLHttpRequest;d.onreadystatechange=t(d,b,e);d.open("get",
u(a,c));d.send()}function u(a,b){a+=0<a.indexOf("?")?"&":"?";a+="refreshajax="+f.encodeURIComponent(g);a+="&navigation="+(b?"refresh":"history");b&&(a=k(b,a,"include-current"),a=k(b,a,"current-keys"),a=k(b,a,"to-keys"));return a}function k(a,b,c){(a=a.getAttribute("data-"+c))&&(b+="&"+c.replace("-","")+"="+f.encodeURIComponent(a));return b}function t(a,b,c){var e=g;return function(){if(4===a.readyState&&200===a.status){var d=f.JSON.parse(a.responseText);d.Title||(d.Title=c?c:f.document.title);v(d,
b,e)}}}function v(a,b,c){if(a.RedirectLink)f.location.href=a.RedirectLink;else if(g===c){c={};c.Link=g;c.Title=f.document.title;c.Panels={};for(var e in a.Panels){var d=f.document.getElementById(e);c.Panels[e]=d.innerHTML;d.innerHTML=a.Panels[e];var p;"function"===typeof f.Event?p=new f.Event("refreshajax"):(p=f.document.createEvent("Event"),p.initEvent("refreshajax",!1,!1));d.dispatchEvent(p)}e=a.Link;g!==e&&(d=a.Link,l[g+"&"+d]=a,l[d+"&"+g]=c,-1===m.indexOf(d)&&(n[d]=[],m.push(d)),-1===n[g].indexOf(d)&&
(n[g].push(d),n[d].push(g)),b&&f.history.pushState(a.Title,a.Title,e));f.document.title=a.Title;g=e}}function A(a,b){for(var c={},e={},d=[],f=m.length,g=0;g<m.length;g++)d.push(m[g]),e[m[g]]=f;for(var h=e[a]=0;0!==d.length;){h++;var k=d.sort(function(a,b){return e[a]-e[b]})[0];if(k===b){for(d=[];b;)d.push(b),b=c[b];return d.reverse()}for(var l=n[k],g=0;g<l.length;g++){var q=l[g];e[q]===f&&(e[q]=h,c[q]=k)}d.shift()}return null}if(f.history&&f.history.pushState){var h={};f.document.addEventListener("click",
function(a){var b=a.target,c=r(b,"A");a.ctrlKey||a.shiftKey||!c||(a.preventDefault(),s(c.getAttribute("href"),!0,c));"INPUT"===b.tagName&&b.name&&("submit"===b.type&&(h[b.name]=b.value),"image"===b.type&&(h[b.name+".x"]=f.Math.max(0,a.offsetX),h[b.name+".y"]=f.Math.max(0,a.offsetY)))});f.document.addEventListener("submit",function(a){var b=r(a.target,"FORM");if(b){var c=new f.XMLHttpRequest;c.onreadystatechange=t(c,!0);a.preventDefault();c.open("post",u(b.getAttribute("action"),b));c.setRequestHeader("Content-Type",
"application/json");c.send(f.JSON.stringify(w(b)))}});var x=/^INPUT|TEXTAREA|SELECT$/,y=/^button|image|submit|reset|file$/,z=/^checkbox|radio$/,g=f.location.pathname+f.location.search,l={},n={};n[g]=[];var m=[g];f.addEventListener("popstate",function(a){var b=f.location.pathname+f.location.search;if(g!==b){var c=A(g,b);if(c)for(a=0;a<c.length-1;a++)v(l[c[a]+"&"+c[a+1]],!1,c[a]);else s(b,!1,null,a.state)}})}})(window);