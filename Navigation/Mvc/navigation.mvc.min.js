(function(d){function m(a,b){if(a.tagName===b&&"refresh"===a.getAttribute("data-navigation")){for(var c=!0;a&&c;)a.getAttribute&&(c="noajax"!==a.getAttribute("data-navigation")),a=a.parentNode;return c}return!1}function n(a,b){var c=new d.XMLHttpRequest;c.onreadystatechange=p(c,b,a);c.open("get",q(a));c.send()}function q(a){a+=0<a.indexOf("?")?"&":"?";return a+="refreshajax="+d.encodeURIComponent(e)}function p(a,b,c){var l=e;return function(){if(4===a.readyState&&200===a.status){var g=d.JSON.parse(a.responseText);
r(g,b,c,l)}}}function r(a,b,c,l){for(var g in a.Panels){var f=d.document.getElementById(g);f.innerHTML=a.Panels[g];var h;"function"===typeof d.Event?h=new d.Event("refreshajax"):(h=d.document.createEvent("Event"),h.initEvent("refreshajax",!1,!1));f.dispatchEvent(h)}c||(c=a.Link);b&&e!==c&&d.history.pushState(c,d.document.title,c);s[l+"&"+c]=a;e=c}if(d.history&&d.history.pushState){var k={};d.document.addEventListener("click",function(a){var b=a.target;a.ctrlKey||a.shiftKey||!m(b,"A")||(a.preventDefault(),
n(b.getAttribute("href"),!0));"INPUT"===b.tagName&&b.name&&("submit"===b.type&&(k[b.name]=b.value),"image"===b.type&&(k[b.name+".x"]=d.Math.max(0,a.offsetX),k[b.name+".y"]=d.Math.max(0,a.offsetY)))});var t=/^(INPUT|TEXTAREA|SELECT)$/,u=/^(button|image|submit|reset|file)$/,v=/^(checkbox|radio)$/;d.document.addEventListener("submit",function(a){if(m(a.target,"FORM")){var b=a.target.elements,c=new d.XMLHttpRequest;c.onreadystatechange=p(c,!0,null);for(var e={},g=0;g<b.length;g++){var f=b[g];!t.test(f.tagName)||
!f.name||u.test(f.type)||f.disabled||v.test(f.type)&&!f.checked||(e[f.name]=f.value)}for(var h in k)e[h]=k[h];k={};a.preventDefault();c.open("post",q(a.target.getAttribute("action")));c.setRequestHeader("Content-Type","application/json");c.send(d.JSON.stringify(e))}});var e=d.location.pathname+d.location.search,s={};d.addEventListener("popstate",function(a){a=d.location.pathname+d.location.search;if(e!==a){var b=s[e+"&"+a];b?r(b,!1,a,e):n(a,!1)}})}})(window);